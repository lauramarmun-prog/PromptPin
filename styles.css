:root{
  --bg:#f7f6ff;
  --card:#ffffff;
  --text:#1b1d2a;
  --muted:#5a5f7a;
  --border: rgba(183,168,255,.35);

  --input-bg: rgba(255,255,255,.78);
  --input-text: var(--text);
  --input-placeholder: rgba(27,29,42,.45);

  --shadow: 0 12px 30px rgba(0,0,0,.12);
  --shadow2: 0 10px 20px rgba(20, 10, 40, .10);
  --radius: 18px;
  --accent: #b7a8ff;
  --accent2: #76e0ff;
  --brand-prompt: #8f7dff;
  --brand-pin: #2db9ea;
  --bg-grad: radial-gradient(1200px 600px at 20% 0%, rgba(183,168,255,.20), transparent 60%),
             radial-gradient(900px 500px at 90% 10%, rgba(118,224,255,.18), transparent 55%);
}

*{ box-sizing: border-box; }
html,body{ height: 100%; }
body{
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: var(--bg-grad), var(--bg);
  color: var(--text);
}

/* =========================
   THEME TOGGLE (Dark)
   ========================= */

/* Dark theme overrides */
:root[data-theme="dark"]{
  --bg:#0f1020;
  --card:#171833;
  --text:#f3f3ff;
  --muted:#c9c6ff;
  --border: rgba(118,224,255,.35);

  --input-bg: rgba(255,255,255,.08);
  --input-text: var(--text);
  --input-placeholder: rgba(243,243,255,.55);

  --shadow: 0 12px 30px rgba(0,0,0,.35);
  --accent: #8f86ff;
  --accent2: #4fd7ff;
  --brand-prompt: #c5bbff;
  --brand-pin: #7de3ff;
  --bg-grad: radial-gradient(1200px 600px at 70% 10%, rgba(79,215,255,.10), transparent 55%),
             radial-gradient(900px 500px at 20% 0%, rgba(143,134,255,.12), transparent 55%);
}

#themeToggle{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.35);
  color: var(--text);
  font-weight: 700;
  cursor: pointer;
  box-shadow: var(--shadow);
}

#themeToggle:hover{
  background: rgba(183,168,255,.16);
  border-color: rgba(118,224,255,.55);
}

:root[data-theme="dark"] #themeToggle{
  background: rgba(255,255,255,.08);
  border-color: rgba(118,224,255,.35);
}

:root[data-theme="dark"] #themeToggle:hover{
  background: rgba(143,134,255,.18);
  border-color: rgba(79,215,255,.55);
}

#themeToggle .themeIcon{
  font-size: 16px;
  line-height: 1;
  filter: none;
}
.topbar{
  position: sticky; top: 0; z-index: 10;
  backdrop-filter: blur(10px);
  background: rgba(250, 247, 255, .7);
  border-bottom: 1px solid var(--border);
  padding: 14px 16px;
  display:flex; align-items:center; justify-content:space-between;
  gap: 12px;
}

:root[data-theme="dark"] .topbar{
  background: rgba(15, 16, 32, .82);
}

.brand{ display:flex; align-items:center; gap: 12px; }
.logo{
  width: 44px; height: 44px; border-radius: 16px;
  display:grid; place-items:center;
  background: rgba(183,168,255,.25);
  border: 1px solid var(--border);
  box-shadow: var(--shadow2);
}
.brand-name{ font-weight: 800; letter-spacing: .2px; }
.brand-byline{
  font-size: 10px;
  letter-spacing: .3px;
  color: rgba(120,120,140,.9);
  margin-top: 2px;
}
:root[data-theme="dark"] .brand-byline{
  color: rgba(220,220,240,.75);
}
.brand-prompt{ color: var(--brand-prompt); }
.brand-pin{ color: var(--brand-pin); }

.nav{ display:flex; gap: 8px; }
.navbtn{
  border: 1px solid var(--border);
  background: rgba(255,255,255,.7);
  padding: 10px 12px;
  border-radius: 14px;
  cursor: pointer;
  box-shadow: 0 6px 14px rgba(20, 10, 40, .06);
}
.navbtn.active{
  background: rgba(183,168,255,.28);
  border-color: rgba(183,168,255,.7);
}

:root[data-theme="dark"] .navbtn{
  background: rgba(20, 18, 30, .85);
  border-color: rgba(118,224,255,.25);
  color: var(--text);
}

:root[data-theme="dark"] .navbtn.active{
  background: rgba(143,134,255,.25);
  border-color: rgba(143,134,255,.55);
}

.container{ max-width: 1040px; margin: 0 auto; padding: 16px; }
.view.hidden{ display:none; }

.view{
  position: relative;
}


.album-toolbar{
  display:flex; align-items:center; justify-content:space-between;
  gap: 12px; margin: 10px 0 16px;
}
.search{
  width: 100%;
  max-width: 520px;
  border-radius: 16px;
  padding: 12px 14px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--input-text);
  outline: none;
}

.search,
.textarea,
.pre,
.preset-descarea,
.modal-card textarea,
.modal-card pre{
  background: var(--input-bg);
  color: var(--input-text);
  border: 1px solid var(--border);
}

.search::placeholder,
.textarea::placeholder{
  color: var(--input-placeholder);
}

/* Si tu prompt "resultado" es un <textarea> o <pre> con clase especifica,
   ponlo tambien aqui por si acaso */
#templateInput,
#resultOutput{
  background: var(--input-bg);
  color: var(--input-text);
  border: 1px solid var(--border);
}
.search::placeholder{ color: var(--input-placeholder); }
.search:focus{ border-color: rgba(118,224,255,.8); box-shadow: 0 0 0 4px rgba(118,224,255,.18); }

.primary, .ghost, .chip{
  border-radius: 16px;
  padding: 12px 14px;
  border: 1px solid transparent;
  cursor: pointer;
  font-weight: 700;
}
.primary{
  background: linear-gradient(135deg, rgba(183,168,255,.95), rgba(118,224,255,.55));
  color: #221a3a;
  box-shadow: var(--shadow2);
}
.primary:disabled{
  opacity: .55;
  cursor:not-allowed;
}
.ghost{
  background: rgba(255,255,255,.75);
  border-color: var(--border);
  color: var(--text);
}

:root[data-theme="dark"] .primary{
  background: linear-gradient(135deg, rgba(143,134,255,.9), rgba(79,215,255,.45));
  color: #0b0c14;
}

:root[data-theme="dark"] .ghost{
  background: rgba(255,255,255,.08);
  border-color: rgba(118,224,255,.25);
  color: var(--text);
}
.chip{
  background: rgba(183,168,255,.22);
  border-color: rgba(183,168,255,.45);
  padding: 9px 12px;
  font-weight: 700;
}

/* Empty */
.empty{ margin-top: 20px; }
.empty-card{
  max-width: 420px;
  margin: 0 auto;
  background: rgba(255,255,255,.85);
  border: 1px solid var(--border);
  border-radius: 22px;
  padding: 18px;
  box-shadow: var(--shadow);
  text-align:center;
}
.empty-card{
  color: var(--text);
}
:root[data-theme="dark"] .empty-card{
  background: rgba(17,19,38,.88);
  border-color: rgba(118,224,255,.22);
}
.empty-emoji{ font-size: 34px; }
.empty-title{ font-size: 18px; font-weight: 850; margin-top: 6px; }
.empty-title{ color: var(--text); }
:root[data-theme="dark"] .empty-title{
  color: var(--text);
}
.empty-text{ color: var(--muted); margin: 8px 0 14px; }
:root[data-theme="dark"] .empty-text{
  color: rgba(242,243,255,.72);
}

/* Masonry: easy Pinterest style */
.masonry{
  column-count: 2;
  column-gap: 14px;
}
@media (min-width: 700px){
  .masonry{ column-count: 3; }
}
@media (min-width: 980px){
  .masonry{ column-count: 4; }
}

.loadmore{
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  margin: 10px 0 20px;
}

.pin{
  break-inside: avoid;
  margin: 0 0 14px;
  background: rgba(255,255,255,.92);
  border: 1px solid var(--border);
  border-radius: 20px;
  box-shadow: var(--shadow2);
  overflow:hidden;
  position: relative;
  transform: translateZ(0);
  transition: transform .12s ease, box-shadow .12s ease;
}
.pin:hover{
  transform: translateY(-2px);
  box-shadow: var(--shadow);
}
:root[data-theme="dark"] .pin{
  background: rgba(17,19,38,.88);
  border-color: rgba(183,168,255,.20);
}
.pin img{ width: 100%; display:block; }
.pin-meta{
  padding: 10px 12px 12px;
}
.pin-title{
  font-weight: 850;
  font-size: 13px;
  white-space: nowrap;
  overflow:hidden;
  text-overflow: ellipsis;
}
.pin-sub{
  margin-top: 6px;
  color: var(--muted);
  font-size: 12px;
  line-height: 1.3;
  max-height: 2.6em;
  overflow:hidden;
}
:root[data-theme="dark"] .pin-sub{
  color: rgba(242,243,255,.78);
}
.pin-credit{
  color: var(--muted);
  font-size: 12px;
  margin-top: 6px;
}
.pin-date{
  color: var(--muted);
  font-size: 12px;
  margin-top: 4px;
}
:root[data-theme="dark"] .pin-sub{
  color: rgba(242,243,255,.78);
}
.pin-actions{
  position: absolute;
  top: 10px;
  right: 10px;
  display:flex;
  gap: 8px;
  opacity: 0;
  transform: translateY(-2px);
  transition: opacity .12s ease, transform .12s ease;
}
.pin:hover .pin-actions{ opacity: 1; transform: translateY(0); }
.pin-variant-badge{
  position: absolute;
  top: 10px;
  left: 10px;
  z-index: 2;
  background: linear-gradient(135deg, #ffd93d, #ff7b36);
  color: #201600;
  border: 1px solid rgba(255,255,255,.7);
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 11px;
  font-weight: 900;
  letter-spacing: .2px;
  box-shadow: 0 8px 14px rgba(255,123,54,.35);
}

:root[data-theme="dark"] .pin-variant-badge{
  border-color: rgba(0,0,0,.35);
  box-shadow: 0 8px 16px rgba(255,140,44,.35);
}
.actionbtn{
  padding: 9px 12px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.85);
  font-weight: 800;
  cursor: pointer;
}
:root[data-theme="dark"] .actionbtn{
  background: rgba(255,255,255,.08);
  border-color: rgba(118,224,255,.25);
  color: var(--text);
}

/* Builder */
.builder{
  display:flex;
  flex-direction: column;
  gap: 16px;
  padding-bottom: 86px; /* room for stickybar */
}
.field{ display:flex; flex-direction:column; gap: 8px; }
.label{ font-weight: 850; font-size: 13px; }
:root[data-theme="dark"] .label{
  color: var(--text);
}
.textarea{
  border-radius: 18px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--input-text);
  padding: 12px;
  outline: none;
  font: inherit;
  line-height: 1.4;
}
.textarea::placeholder{ color: var(--input-placeholder); }
.textarea:focus{ border-color: rgba(118,224,255,.8); box-shadow: 0 0 0 4px rgba(118,224,255,.18); }

.dropzone{
  border-radius: 22px;
  border: 2px dashed rgba(183,168,255,.6);
  background: rgba(255,255,255,.6);
  padding: 18px;
  box-shadow: 0 10px 18px rgba(20,10,40,.06);
  cursor:pointer;
}
.dropzone:focus{ outline: none; box-shadow: 0 0 0 4px rgba(183,168,255,.22); }
.dz-title{ font-weight: 900; }
.dz-sub{ color: var(--muted); margin-top: 4px; font-size: 12px; }
.dz-sub{ color: var(--muted); }

.preview-wrap{ display:flex; flex-direction:column; gap: 10px; }
.preview{
  width: 100%;
  max-height: 380px;
  object-fit: contain;
  border-radius: 18px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.85);
}

.hint{ color: var(--muted); font-size: 12px; padding: 2px 2px 10px; }
.hint{ color: var(--muted); }

/* Builder ownership */
.row{
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 10px 12px;
  margin: 6px 0 8px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.7);
  font-weight: 700;
  box-shadow: var(--shadow2);
  font-size: 14px;
  color: var(--accent);
}
.row input[type="checkbox"]{
  width: 18px;
  height: 18px;
  accent-color: var(--accent);
}

#creditFields{
  display:grid;
  gap: 10px;
  padding: 12px;
  margin-bottom: 8px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.7);
  box-shadow: var(--shadow2);
}

/* Mood picker */
.mood-picker{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

.mood-option{
  display:flex;
  align-items:center;
  gap:6px;
  padding:8px 14px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--card);
  cursor:pointer;
  font-weight:600;
  opacity:.8;
  color: var(--text);
}

.mood-option input{
  display:none;
}

.mood-option:has(input:checked){
  background: rgba(183,168,255,.18);
  border-color: rgba(183,168,255,.6);
  opacity:1;
}

:root[data-theme="dark"] .mood-option{
  background: rgba(17,19,38,.75);
  border-color: rgba(118,224,255,.22);
}

:root[data-theme="dark"] .mood-option:has(input:checked){
  background: rgba(143,134,255,.22);
  border-color: rgba(143,134,255,.55);
}

#creditFields input{
  border-radius: 14px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--input-text);
  padding: 10px 12px;
  outline: none;
}
#creditFields input::placeholder{ color: var(--input-placeholder); }
#creditFields input:focus{
  border-color: rgba(118,224,255,.8);
  box-shadow: 0 0 0 3px rgba(118,224,255,.18);
}

:root[data-theme="dark"] .row{
  background: rgba(17,19,38,.78);
}
:root[data-theme="dark"] #creditFields{
  background: rgba(17,19,38,.72);
  border-color: rgba(118,224,255,.22);
  box-shadow: 0 12px 30px rgba(0,0,0,.45);
}

/* Sticky bar */
.stickybar{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  padding: 12px 16px calc(12px + env(safe-area-inset-bottom));
  background: rgba(250, 247, 255, .78);
  border-top: 1px solid var(--border);
  backdrop-filter: blur(10px);
  display:flex;
  gap: 10px;
  justify-content:center;
}
:root[data-theme="dark"] .stickybar{
  background: rgba(15, 16, 32, .85);
  border-top: 1px solid rgba(118,224,255,.25);
}
.stickybar > button{ flex: 1; max-width: 520px; }
@media (min-width: 800px){
  .stickybar{ position: sticky; bottom: 0; border-radius: 22px; margin-top: 8px; }
  .stickybar > button{ max-width: 220px; }
}

/* Modal */
.modal.hidden{ display:none; }
.modal{
  position: fixed; inset: 0; z-index: 50;
  display:grid; place-items:center;
  padding: 16px;
}
.modal-backdrop{
  position:absolute; inset:0;
  background: rgba(20,10,40,.35);
}
.modal-card{
  position: relative;
  width: min(820px, 100%);
  max-height: min(92vh, 900px);
  overflow: hidden;
  border-radius: 24px;
  background: rgba(255,255,255,.92);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  display:flex;
  flex-direction:column;
}
:root[data-theme="dark"] .modal-card{
  background: rgba(17,19,38,.92);
  border-color: rgba(118,224,255,.22);
}
:root[data-theme="dark"] .modal-backdrop{
  background: rgba(10, 8, 16, .6);
}
.modal-head{
  display:flex; align-items:center; justify-content:space-between;
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
}
.modal-title{ font-weight: 900; }
.iconbtn{
  border-radius: 14px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.8);
  padding: 8px 10px;
  cursor:pointer;
  font-weight: 900;
}
:root[data-theme="dark"] .iconbtn{
  background: rgba(143,134,255,.25);
  border-color: rgba(79,215,255,.35);
  color: var(--text);
}
.modal-body{
  padding: 14px;
  overflow:auto;
  padding-bottom: 90px; /* sticky modalbar */
}
.modal-img{
  width: 100%;
  border-radius: 18px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,.85);
}
.modal-img{
  background: var(--input-bg);
}
:root[data-theme="dark"] .modal-img{
  border-color: rgba(118,224,255,.22);
}
.modal-section{ margin-top: 12px; }
.modal-variants-list{
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(64px, 1fr));
  gap: 8px;
  margin-top: 8px;
}
.variant-chip{
  border: 2px solid transparent;
  border-radius: 12px;
  padding: 0;
  background: rgba(255,255,255,.7);
  cursor: pointer;
  overflow: hidden;
}
.variant-chip img{
  width: 100%;
  height: 64px;
  object-fit: cover;
  display: block;
}
.variant-chip.active{
  border-color: #ff7b36;
  box-shadow: 0 0 0 2px rgba(255,123,54,.2);
}
:root[data-theme="dark"] .variant-chip{
  background: rgba(255,255,255,.08);
  border-color: rgba(118,224,255,.18);
}
:root[data-theme="dark"] .variant-chip.active{
  border-color: #ffb020;
  box-shadow: 0 0 0 2px rgba(255,176,32,.2);
}
.pre{
  white-space: pre-wrap;
  word-break: break-word;
  background: rgba(255,255,255,.75);
  border: 1px solid var(--border);
  border-radius: 18px;
  padding: 10px 12px;
  margin: 8px 0 0;
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  font-size: 12px;
}
:root[data-theme="dark"] .pre{
  background: rgba(255,255,255,.06);
  border-color: rgba(118,224,255,.22);
  color: var(--text);
}
.pre.muted{ color: var(--muted); }
:root[data-theme="dark"] .pre.muted{
  color: rgba(242,243,255,.62);
}
.modalbar{
  position: absolute;
  left: 0; right: 0; bottom: 0;
}

/* Toast */
.toast{
  position: fixed;
  left: 50%;
  bottom: 92px;
  transform: translateX(-50%);
  background: rgba(30,26,43,.92);
  color: #fff;
  padding: 10px 14px;
  border-radius: 16px;
  box-shadow: 0 12px 30px rgba(20,10,40,.20);
  opacity: 0;
  pointer-events:none;
  transition: opacity .14s ease, transform .14s ease;
}
.toast.show{
  opacity: 1;
  transform: translateX(-50%) translateY(-2px);
}

.hidden{ display:none !important; }
/* --- Tabs (My Prompts / Saved) --- */
.tabs{
  display:flex;
  gap:10px;
  align-items:center;
  margin: 10px 0 16px;
}

.tab{
  border: 1px solid rgba(183,168,255,.35);
  background: rgba(255,255,255,.06);
  color: var(--text);
  padding: 8px 14px;
  border-radius: 999px;
  font-weight: 600;
  cursor: pointer;
  transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
  backdrop-filter: blur(8px);
}

.tab:hover{
  transform: translateY(-1px);
  border-color: rgba(183,168,255,.6);
  box-shadow: 0 10px 24px rgba(183,168,255,.12);
}

.tab.active{
  background: rgba(183,168,255,.18);
  border-color: rgba(118,224,255,.65);
  box-shadow: 0 12px 30px rgba(118,224,255,.16);
}

:root[data-theme="dark"] .tab{
  background: rgba(17,19,38,.6);
  border-color: rgba(118,224,255,.22);
  color: var(--text);
}

:root[data-theme="dark"] .tab.active{
  background: rgba(143,134,255,.24);
  border-color: rgba(143,134,255,.6);
  box-shadow: 0 12px 30px rgba(143,134,255,.18);
}
.tab-count{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  margin-left: 8px;
  min-width: 24px;
  height: 20px;
  padding: 0 8px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
  color: var(--text);
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(183,168,255,.25);
}
:root[data-theme="dark"] .tab-count{
  background: rgba(17,19,38,.7);
  border-color: rgba(118,224,255,.22);
  color: var(--text);
}
.tab.active .tab-count{
  background: rgba(118,224,255,.14);
  border-color: rgba(118,224,255,.45);
}

.album-toolbar{
  display:flex;
  align-items:flex-start; /* para que el botón quede arriba y el left pueda tener dos filas */
  justify-content: space-between;
  gap: 18px;
}

.toolbar-left{
  display:flex;
  flex-direction: column;
  gap: 10px; /* espacio entre search y tabs */
  flex: 1;
  max-width: 720px; /* opcional: para que no sea infinito */
}

.tabs-under-search{
  margin: 0;
}

/* Overlay encima del grid */
.tabs-overlay{
  position: absolute;
  left: 24px;
  top: 64px;              /* ajusta: más arriba/abajo */
  z-index: 10;
  margin: 0;
}

/* Para que no choque con el overlay, empuja el grid un poquito */
#grid{
  padding-top: 44px;      /* ajusta según el tamaño de tabs */
}

.preset-list{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 16px;
  margin-top: 12px;
}

.preset-card{
  background: rgba(255,255,255,.6);
  border: 1px solid rgba(183,168,255,.25);
  border-radius: 18px;
  padding: 14px;
  box-shadow: 0 12px 30px rgba(0,0,0,.06);
  display:flex;
  gap: 12px;
}
:root[data-theme="dark"] .preset-card{
  background: rgba(17,19,38,.88);
  border-color: rgba(183,168,255,.20);
}

.preset-avatar{
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: rgba(183,168,255,.25);
  overflow:hidden;
  flex: 0 0 auto;
}

.preset-avatar img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.preset-body{
  flex:1;
}

.preset-name{
  font-weight: 800;
  margin-bottom: 4px;
}

.preset-desc{
  color: var(--muted);
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
:root[data-theme="dark"] .preset-desc{
  color: rgba(242,243,255,.75);
}

.preset-actions{
  display:flex;
  gap:8px;
  margin-top:8px;
}

.preset-actions .actionbtn{
  padding:6px 10px;
}
/* Preset editor */
.preset-editor-row{
  display:flex;
  gap: 14px;
  align-items:flex-start;
}

.preset-editor-avatar{
  width: 72px;
  height: 72px;
  border-radius: 50%;
  background: rgba(183,168,255,.18);
  border: 1px dashed rgba(183,168,255,.45);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  cursor:pointer;
  position: relative;
  flex: 0 0 auto;
}

.preset-editor-avatar img{
  width:100%;
  height:100%;
  object-fit: cover;
  display:none;
}

.preset-editor-avatar-fallback{
  font-weight: 900;
  font-size: 22px;
  color: rgba(243,243,255,.85);
}

.preset-editor-fields{
  flex: 1;
}

/* If you don't have .input already, this matches your style */
.input{
  width: 100%;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--input-text);
  outline: none;
}
.input::placeholder{ color: var(--input-placeholder); }

.select{
  width: 100%;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid var(--border);
  background: var(--input-bg);
  color: var(--input-text);
  outline: none;
}
.select:focus{
  border-color: rgba(118,224,255,.8);
  box-shadow: 0 0 0 3px rgba(118,224,255,.18);
}

:root[data-theme="dark"] select,
:root[data-theme="dark"] option{
  background-color: #171833;
  color: #f3f3ff;
}
.input:focus{
  border-color: rgba(118,224,255,.55);
  box-shadow: 0 12px 30px rgba(118,224,255,.10);
}

.preset-editor-actions{
  margin-top: 12px;
  display:flex;
  gap: 10px;
  align-items:center;
}


#view-presets .album-head{
  max-width: 980px;
  margin: 0 auto;
  padding: 18px 16px 0;
}

#view-presets .album-toolbar{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
}

#view-presets .toolbar-left{
  flex: 1;
  max-width: 520px;
}

#view-presets #presetSearch{
  width: 100%;
}

#view-presets #newPresetBtn{
  margin-left: auto;
}

#view-presets #presetGrid{
  max-width: 980px;
  margin: 14px auto 0;
  padding: 0 16px 24px;
}
/* --- Prompt Mixer --- */
.mixer{
  max-width: 980px;
  margin: 18px auto 0;
  padding: 0 16px 24px;
}

.mixer-row{
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 14px;
  align-items: start;
  margin: 12px 0;
}

.mixer-actions{
  display:flex;
  flex-direction: column;
  gap: 10px;
  min-width: 180px;
}

.mixer-picklist{
  display: grid;
  gap: 10px;
  margin-top: 10px;
}

.mixer-item{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(183,168,255,.25);
  background: rgba(255,255,255,.06);
  box-shadow: 0 10px 28px rgba(0,0,0,.14);
}

.mixer-item-left{
  display:flex;
  align-items:center;
  gap: 10px;
  min-width: 0;
}

.mixer-check{
  width: 18px;
  height: 18px;
  accent-color: var(--accent);
}

.mixer-order{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width: 26px;
  height: 22px;
  padding: 0 8px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 800;
  color: var(--text);
  border: 1px solid rgba(118,224,255,.35);
  background: rgba(118,224,255,.10);
}

.mixer-name{
  font-weight: 800;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.mixer-controls{
  display:flex;
  gap: 8px;
}

.iconbtn{
  width: 36px;
  height: 32px;
  border-radius: 12px;
  border: 1px solid rgba(183,168,255,.25);
  background: rgba(255,255,255,.08);
  cursor: pointer;
}

.iconbtn:disabled{
  opacity: .45;
  cursor: not-allowed;
}

@media (max-width: 820px){
  .mixer-row{ grid-template-columns: 1fr; }
  .mixer-actions{ flex-direction: row; flex-wrap: wrap; }
}
.preset-editor textarea {
  width: 100%;
  min-height: 180px;
  max-height: 320px;
  resize: vertical;
  padding: 16px 18px;
  font-family: inherit;
  font-size: 15px;
  line-height: 1.6;
  border-radius: 16px;
  border: 1px solid rgba(183,168,255,.35);
  background: rgba(255,255,255,.55);
  box-shadow: inset 0 1px 2px rgba(0,0,0,.04);
}

.preset-editor textarea:focus {
  outline: none;
  border-color: rgba(118,224,255,.8);
  box-shadow: 0 0 0 3px rgba(118,224,255,.15);
}
/* =========================
   DARK MODE readability fixes
   ========================= */

:root[data-theme="dark"]{
  --text: #f2f3ff;
  --muted: rgba(242,243,255,.72);
}

:root[data-theme="dark"] .pin,
:root[data-theme="dark"] .preset-card,
:root[data-theme="dark"] .modal-card{
  background: rgba(17,19,38,.88);
  border-color: rgba(183,168,255,.20);
}

:root[data-theme="dark"] .pin-title{
  color: var(--text);
}

:root[data-theme="dark"] .pin-sub{
  color: rgba(242,243,255,.78);
}

:root[data-theme="dark"] .muted{
  color: rgba(242,243,255,.68);
}

:root[data-theme="dark"] input,
:root[data-theme="dark"] textarea,
:root[data-theme="dark"] pre{
  color: var(--text);
  background: rgba(255,255,255,.06);
  border-color: rgba(183,168,255,.22);
}

:root[data-theme="dark"] input::placeholder,
:root[data-theme="dark"] textarea::placeholder{
  color: rgba(242,243,255,.45);
}
.mood-sidebar{
  display:flex;
  flex-wrap: wrap;
  gap:10px;
}

.mood-sidebar button{
  padding:10px 14px;
  border-radius:999px;
  background: var(--card);
  border:1px solid var(--border);
  cursor:pointer;
  opacity:.7;
  font-weight:600;
}

.mood-sidebar button.active{
  background: rgba(183,168,255,.18);
  border-color: rgba(183,168,255,.6);
  opacity:1;
}

:root[data-theme="dark"] .mood-sidebar button{
  background: rgba(17,19,38,.7);
  border-color: rgba(118,224,255,.22);
  color: var(--text);
}

:root[data-theme="dark"] .mood-sidebar button.active{
  background: rgba(143,134,255,.22);
  border-color: rgba(143,134,255,.55);
}
